<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volty Strategy Live Binance Trading</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-theme">
    <div class="loading-indicator" id="loadingIndicator">
        <div class="spinner"></div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Binance API Authentication</h5>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <strong>Note:</strong> Your API keys are stored locally in your browser and are never sent to our servers.
                    </div>
                    <form id="apiKeyForm">
                        <div class="mb-3">
                            <label for="apiKey" class="form-label">API Key</label>
                            <input type="text" class="form-control" id="apiKey" placeholder="Enter your Binance API Key" required>
                        </div>
                        <div class="mb-3">
                            <label for="apiSecret" class="form-label">API Secret</label>
                            <input type="password" class="form-control" id="apiSecret" placeholder="Enter your Binance API Secret" required>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="rememberKeys">
                            <label class="form-check-label" for="rememberKeys">
                                Remember API keys (encrypted)
                            </label>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">Connect to Binance</button>
                            <a href="https://www.binance.com/en/my/settings/api-management" target="_blank" class="btn btn-outline-secondary">Get API Keys from Binance</a>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="usePaperTradingBtn">Switch to Paper Trading</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar">
                <h5 class="mb-3">‚öôÔ∏è Strategy Configuration</h5>
                
                <!-- Live Clock Display -->
                <div class="clock-display" id="clock-display">
                    2025-06-07 20:04:07 UTC
                </div>
                
                <div class="status-indicator idle" id="bot-status">
                    üî¥ LIVE TRADING - IDLE
                </div>
                
                <div id="mobile-info" class="mobile-info" style="display: none;">
                    <h6>üì± Mobile Device Detected</h6>
                    <p>This app is optimized for desktop. Some features may be limited on mobile devices.</p>
                </div>
                
                <!-- Bot Activity Section -->
                <div class="bot-activity waiting" id="bot-activity">
                    <div><strong>Bot Activity:</strong> <span id="activity-status">Trading Inactive</span></div>
                    <div class="last-tick-info" id="last-tick-info">Last check: Never</div>
                </div>
                
                <!-- Market Data Summary -->
                <div class="market-data" id="market-data">
                    <div class="market-data-item">
                        <div class="market-label">PRICE</div>
                        <div class="market-value" id="market-price">$0.00</div>
                    </div>
                    <div class="market-data-item">
                        <div class="market-label">24H CHANGE</div>
                        <div class="market-value" id="market-change">0.00%</div>
                    </div>
                    <div class="market-data-item">
                        <div class="market-label">VOLUME</div>
                        <div class="market-value" id="market-volume">$0</div>
                    </div>
                </div>
                
                <hr>
                
                <h6>üìä Data Settings</h6>
                <div class="mb-3">
                    <label for="symbol" class="form-label">Symbol</label>
                    <select class="form-select" id="symbol">
                        <option value="BTCUSDT">BTCUSDT</option>
                        <option value="ETHUSDT">ETHUSDT</option>
                        <option value="ADAUSDT">ADAUSDT</option>
                        <option value="SOLUSDT">SOLUSDT</option>
                        <option value="BNBUSDT">BNBUSDT</option>
                        <option value="XRPUSDT">XRPUSDT</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label for="timeframe" class="form-label">Timeframe</label>
                    <select class="form-select" id="timeframe">
                        <option value="1m">1m</option>
                        <option value="5m">5m</option>
                        <option value="15m">15m</option>
                        <option value="30m">30m</option>
                        <option value="1h" selected>1h</option>
                        <option value="4h">4h</option>
                        <option value="1d">1d</option>
                        <option value="1w">1w</option>
                    </select>
                </div>
                
                <h6 class="mt-4">‚öôÔ∏è Strategy Parameters</h6>
                
                <div class="mb-3">
                    <label for="atr-length" class="form-label">ATR Length</label>
                    <input type="range" class="form-range" id="atr-length" min="1" max="50" value="5">
                    <div class="d-flex justify-content-between">
                        <small>1</small>
                        <small id="atr-length-value">5</small>
                        <small>50</small>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="atr-mult" class="form-label">ATR Multiplier</label>
                    <input type="range" class="form-range" id="atr-mult" min="0.1" max="5.0" step="0.05" value="0.75">
                    <div class="d-flex justify-content-between">
                        <small>0.1</small>
                        <small id="atr-mult-value">0.75</small>
                        <small>5.0</small>
                    </div>
                </div>
                
                <h6 class="mt-4">üí∞ Trading Settings</h6>
                
                <div class="mb-3">
                    <label for="account-balance" class="form-label">Account Balance</label>
                    <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="text" class="form-control" id="account-balance" value="0.00" disabled>
                        <button class="btn btn-outline-secondary" type="button" id="refresh-balance-btn">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="position-size" class="form-label">Position Size (%)</label>
                    <input type="range" class="form-range" id="position-size" min="1" max="100" value="5">
                    <div class="d-flex justify-content-between">
                        <small>1%</small>
                        <small id="position-size-value">5%</small>
                        <small>100%</small>
                    </div>
                </div>
                
                <!-- Trading Statistics -->
                <h6 class="mt-4">üìä Trading Statistics</h6>
                <div class="stats-panel">
                    <div class="stat-item">
                        <div class="stat-value" id="stat-daily-trades">0</div>
                        <div class="stat-label">Today's Trades</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="stat-daily-pnl">$0.00</div>
                        <div class="stat-label">Today's P&L</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="stat-execution">0ms</div>
                        <div class="stat-label">Execution</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="stat-ping">0ms</div>
                        <div class="stat-label">API Ping</div>
                    </div>
                </div>
                
                <hr>
                
                <button id="start-trading-btn" class="btn btn-primary w-100 mb-3">üöÄ Start Trading</button>
                <button id="stop-trading-btn" class="btn btn-danger w-100 mb-3" disabled>‚èπÔ∏è Stop Trading</button>
                <button id="emergency-sell-btn" class="btn btn-warning w-100 mb-3" disabled>‚ö†Ô∏è EMERGENCY SELL</button>
                <button id="logout-btn" class="btn btn-secondary w-100">üîí Logout</button>
            </div>
            
            <!-- Main content -->
            <div class="col-md-9 col-lg-10 ms-auto">
                <h1 class="gradient-header">Volty Strategy Live Binance Trading</h1>
                
                <!-- Performance Metrics -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="total-return">0.00%</div>
                            <div class="metric-label">üí∞ Total Return</div>
                            <div class="metric-delta" id="total-return-delta">$0.00</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="win-rate">0.0%</div>
                            <div class="metric-label">üéØ Win Rate</div>
                            <div class="metric-delta" id="win-rate-delta">0 trades</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="profit-factor">0.00</div>
                            <div class="metric-label">üìà Profit Factor</div>
                            <div class="metric-delta" id="profit-factor-delta">Avg: $0.00</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="max-drawdown">0.00%</div>
                            <div class="metric-label">üìâ Max Drawdown</div>
                            <div class="metric-delta" id="max-drawdown-delta">Sharpe: 0.00</div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="max-win">$0.00</div>
                            <div class="metric-label">üèÜ Max Win</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="max-loss">$0.00</div>
                            <div class="metric-label">üí∏ Max Loss</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="current-balance">$0.00</div>
                            <div class="metric-label">üíº Current Balance</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-value" id="total-trades">0</div>
                            <div class="metric-label">‚ö° Total Trades</div>
                        </div>
                    </div>
                </div>
                
                <!-- Live Position Card -->
                <div class="card mt-4" id="position-card" style="display: none;">
                    <div class="row">
                        <div class="col-md-12">
                            <h5>üî¥ Current Position</h5>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="metric-label">Type</div>
                                    <div class="metric-value" id="position-type">-</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Entry Price</div>
                                    <div class="metric-value" id="position-entry-price">$0.00</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Current Price</div>
                                    <div class="metric-value" id="position-current-price">$0.00</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Unrealized P&L</div>
                                    <div class="metric-value" id="position-pnl">$0.00 (0.00%)</div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-3">
                                    <div class="metric-label">Entry Time</div>
                                    <div class="small" id="position-entry-time">-</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Position Size</div>
                                    <div class="small" id="position-size-info">0.00000000</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Take Profit</div>
                                    <div class="small" id="position-tp">$0.00</div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-label">Stop Loss</div>
                                    <div class="small" id="position-sl">$0.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts -->
                <div class="card mt-4">
                    <ul class="nav nav-tabs" id="mainTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="charts-tab" data-bs-toggle="tab" data-bs-target="#charts-content" type="button" role="tab" aria-controls="charts-content" aria-selected="true">
                                üìä Charts
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="trades-tab" data-bs-toggle="tab" data-bs-target="#trades-content" type="button" role="tab" aria-controls="trades-content" aria-selected="false">
                                üßæ Trade History
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-content" type="button" role="tab" aria-controls="settings-content" aria-selected="false">
                                ‚öôÔ∏è Settings
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="mainTabContent">
                        <!-- Charts Tab -->
                        <div class="tab-pane fade show active" id="charts-content" role="tabpanel" aria-labelledby="charts-tab">
                            <ul class="nav nav-tabs mt-3" id="chartTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="price-tab" data-bs-toggle="tab" data-bs-target="#price-content" type="button" role="tab" aria-controls="price-content" aria-selected="true">
                                        üìà Price Chart & Signals
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="equity-tab" data-bs-toggle="tab" data-bs-target="#equity-content" type="button" role="tab" aria-controls="equity-content" aria-selected="false">
                                        üíπ Equity Curve
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="depth-tab" data-bs-toggle="tab" data-bs-target="#depth-content" type="button" role="tab" aria-controls="depth-content" aria-selected="false">
                                        üìä Market Depth
                                    </button>
                                </li>
                            </ul>
                            <div class="tab-content" id="chartTabContent">
                                <div class="tab-pane fade show active" id="price-content" role="tabpanel" aria-labelledby="price-tab">
                                    <div class="chart-container" style="position: relative; height: 60vh;">
                                        <div id="priceChart"></div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="equity-content" role="tabpanel" aria-labelledby="equity-tab">
                                    <div class="chart-container" style="position: relative; height: 40vh;">
                                        <div id="equityChart"></div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="depth-content" role="tabpanel" aria-labelledby="depth-tab">
                                    <div class="chart-container" style="position: relative; height: 40vh;">
                                        <div id="depthChart"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Trade History Tab -->
                        <div class="tab-pane fade" id="trades-content" role="tabpanel" aria-labelledby="trades-tab">
                            <h5 class="mt-3 mb-3">üìã Trade History</h5>
                            <div class="table-responsive">
                                <table class="trade-history" id="tradeHistory">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Entry Time</th>
                                            <th>Exit Time</th>
                                            <th>Type</th>
                                            <th>Entry Price</th>
                                            <th>Exit Price</th>
                                            <th>Size</th>
                                            <th>P&L</th>
                                            <th>P&L %</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Trade history will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Settings Tab -->
                        <div class="tab-pane fade" id="settings-content" role="tabpanel" aria-labelledby="settings-tab">
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <h5 class="mb-3">‚öôÔ∏è Trading Settings</h5>
                                        
                                        <!-- Auto Trade Toggle -->
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="auto-trade-toggle" checked>
                                            <label class="form-check-label" for="auto-trade-toggle">
                                                <strong>Auto Trade</strong> - Automatically execute trades based on signals
                                            </label>
                                        </div>
                                        
                                        <h6 class="mt-4">Risk Management</h6>
                                        
                                        <!-- Trailing Stop -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="trailing-stop-toggle">
                                            <label class="form-check-label" for="trailing-stop-toggle">
                                                Trailing Stop
                                            </label>
                                        </div>
                                        <div class="input-group mb-3">
                                            <input type="number" class="form-control" id="trailing-stop-value" value="1.5" min="0.1" max="10" step="0.1">
                                            <span class="input-group-text">%</span>
                                        </div>
                                        
                                        <!-- Take Profit -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="take-profit-toggle" checked>
                                            <label class="form-check-label" for="take-profit-toggle">
                                                Take Profit
                                            </label>
                                        </div>
                                        <div class="input-group mb-3">
                                            <input type="number" class="form-control" id="take-profit-value" value="3.0" min="0.1" max="50" step="0.1">
                                            <span class="input-group-text">%</span>
                                        </div>
                                        
                                        <!-- Stop Loss -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="stop-loss-toggle" checked>
                                            <label class="form-check-label" for="stop-loss-toggle">
                                                Stop Loss
                                            </label>
                                        </div>
                                        <div class="input-group mb-3">
                                            <input type="number" class="form-control" id="stop-loss-value" value="2.0" min="0.1" max="20" step="0.1">
                                            <span class="input-group-text">%</span>
                                        </div>
                                        
                                        <!-- Risk Management -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="risk-management-toggle" checked>
                                            <label class="form-check-label" for="risk-management-toggle">
                                                Risk Management Limits
                                            </label>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-6">
                                                <label for="max-drawdown-value" class="form-label">Max Drawdown %</label>
                                                <input type="number" class="form-control" id="max-drawdown-value" value="10" min="1" max="50" step="1">
                                            </div>
                                            <div class="col-6">
                                                <label for="max-daily-loss-value" class="form-label">Max Daily Loss %</label>
                                                <input type="number" class="form-control" id="max-daily-loss-value" value="5" min="1" max="20" step="1">
                                            </div>
                                        </div>
                                        
                                        <h6 class="mt-4">API Settings</h6>
                                        
                                        <!-- API Key Management -->
                                        <div class="mb-3">
                                            <label class="form-label">API Key Status</label>
                                            <div class="d-flex align-items-center">
                                                <span class="badge bg-success me-2" id="api-status-badge">Connected</span>
                                                <span id="api-key-masked">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <button class="btn btn-sm btn-outline-secondary" id="update-api-keys-btn">Update API Keys</button>
                                            <button class="btn btn-sm btn-outline-danger" id="remove-api-keys-btn">Remove API Keys</button>
                                        </div>
                                        
                                        <h6 class="mt-4">Interface Settings</h6>
                                        
                                        <!-- Theme Setting -->
                                        <div class="mb-3">
                                            <label for="theme-select" class="form-label">Theme</label>
                                            <select class="form-select" id="theme-select">
                                                <option value="dark" selected>Dark Theme</option>
                                                <option value="light">Light Theme</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Chart Update Frequency -->
                                        <div class="mb-3">
                                            <label for="chart-update-frequency" class="form-label">Chart Update Frequency</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="chart-update-frequency" value="5" min="1" max="60">
                                                <span class="input-group-text">seconds</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <h5 class="mb-3">üîî Alert Settings</h5>
                                        
                                        <!-- Discord Webhook -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="discord-alert-toggle">
                                            <label class="form-check-label" for="discord-alert-toggle">
                                                Discord Alerts
                                            </label>
                                        </div>
                                        <div class="mb-3">
                                            <input type="text" class="form-control" id="discord-webhook-input" placeholder="Discord Webhook URL">
                                        </div>
                                        
                                        <!-- Telegram Bot -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="telegram-alert-toggle">
                                            <label class="form-check-label" for="telegram-alert-toggle">
                                                Telegram Alerts
                                            </label>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <input type="text" class="form-control" id="telegram-token-input" placeholder="Bot Token">
                                            </div>
                                            <div class="col-md-6">
                                                <input type="text" class="form-control" id="telegram-chatid-input" placeholder="Chat ID">
                                            </div>
                                        </div>
                                        
                                        <!-- Email Alerts -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="email-alert-toggle">
                                            <label class="form-check-label" for="email-alert-toggle">
                                                Email Alerts
                                            </label>
                                        </div>
                                        <div class="mb-3">
                                            <input type="email" class="form-control" id="email-address-input" placeholder="Email Address">
                                        </div>
                                        
                                        <!-- Browser Notifications -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="browser-alert-toggle" checked>
                                            <label class="form-check-label" for="browser-alert-toggle">
                                                Browser Notifications
                                            </label>
                                        </div>
                                        
                                        <!-- Sound Alerts -->
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="sound-alert-toggle" checked>
                                            <label class="form-check-label" for="sound-alert-toggle">
                                                Sound Alerts
                                            </label>
                                        </div>
                                        <div class="mb-4">
                                            <label for="sound-volume-input" class="form-label">Volume</label>
                                            <input type="range" class="form-range" id="sound-volume-input" min="0" max="1" step="0.1" value="0.5">
                                        </div>
                                        
                                        <!-- Test Alert Button -->
                                        <button id="test-alert-btn" class="btn btn-primary mb-3">Test Alerts</button>
                                        
                                        <div class="alert alert-info" role="alert">
                                            <strong>Note:</strong> Discord and Telegram alerts require valid webhook URLs and API tokens. Browser notifications require permission.
                                        </div>
                                    </div>
                                    
                                    <!-- Save Button -->
                                    <button id="save-settings-btn" class="btn btn-success w-100">üíæ Save Settings</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Log Messages -->
                <div class="card mt-4">
                    <h5 class="mb-3">üìù Trading Log</h5>
                    <div style="max-height: 200px; overflow-y: auto;">
                        <div id="logMessages">
                            <!-- Log messages will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js"></script>
    <script src="live.js"></script>
</body>
</html>